{"remainingRequest":"/Users/yuhao/TIMSDK/H5/node_modules/babel-loader/lib/index.js!/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuhao/TIMSDK/H5/src/components/group-live/components/live-header.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuhao/TIMSDK/H5/src/components/group-live/components/live-header.vue","mtime":1616982605599},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yuhao/TIMSDK/H5/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/yuhao/TIMSDK/H5/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from 'vuex';\nexport default {\n  name: 'liveHeader',\n  props: {\n    fr: {\n      type: String,\n      requred: true\n    },\n    isPushingStream: {\n      type: Boolean,\n      default: false\n    },\n    stopPushStream: {\n      type: Function\n    },\n    pusherTime: {\n      type: String,\n      default: ''\n    }\n  },\n  data: function data() {\n    return {\n      nick: '',\n      avatar: 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png',\n      onlineMemberCount: 0,\n      timer: null,\n      onlineList: []\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapState({\n    groupLiveInfo: function groupLiveInfo(state) {\n      return state.groupLive.groupLiveInfo;\n    }\n  })), {}, {\n    showLiveInfo: function showLiveInfo() {\n      return this.fr === 'pusher' && this.isPushingStream || this.fr === 'player';\n    },\n    roomName: function roomName() {\n      return this.groupLiveInfo.roomName || \"\".concat(this.groupLiveInfo.anchorID, \"\\u7684\\u76F4\\u64AD\");\n    }\n  }),\n  mounted: function mounted() {\n    var _this = this;\n\n    this.getAnchorProfile();\n\n    if (this.fr === 'player') {\n      this.timer = setInterval(function () {\n        _this.getGroupOnlineMemberCount();\n      }, 5000);\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.timer && clearInterval(this.timer);\n  },\n  methods: {\n    closeLiveMask: function closeLiveMask() {\n      if (this.fr === 'pusher') {\n        this.stopPushStream();\n        return;\n      }\n\n      this.$store.commit('updateGroupLiveInfo', {\n        isNeededQuitRoom: 1\n      });\n      this.$bus.$emit('close-group-live');\n    },\n    getAnchorProfile: function () {\n      var _getAnchorProfile = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.tim.getUserProfile({\n                  userIDList: [this.groupLiveInfo.anchorID]\n                });\n\n              case 2:\n                res = _context.sent;\n\n                if (res.code === 0) {\n                  this.nick = res.data[0].nick || res.data[0].userID;\n                  this.avatar = res.data[0].avatar || 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png';\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAnchorProfile() {\n        return _getAnchorProfile.apply(this, arguments);\n      }\n\n      return getAnchorProfile;\n    }(),\n    getGroupOnlineMemberCount: function () {\n      var _getGroupOnlineMemberCount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.tim.getGroupOnlineMemberCount(this.groupLiveInfo.roomID);\n\n              case 2:\n                res = _context2.sent;\n\n                if (res.code === 0 && res.data) {\n                  this.onlineMemberCount = res.data.memberCount;\n                }\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getGroupOnlineMemberCount() {\n        return _getGroupOnlineMemberCount.apply(this, arguments);\n      }\n\n      return getGroupOnlineMemberCount;\n    }()\n  },\n  watch: {\n    isPushingStream: function isPushingStream(val) {\n      var _this2 = this;\n\n      if (val && this.fr === 'pusher') {\n        this.timer = setInterval(function () {\n          _this2.getGroupOnlineMemberCount();\n        }, 5000);\n      }\n    }\n  }\n};",{"version":3,"sources":["live-header.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"header-container\">\n    <div v-show=\"showLiveInfo\">\n      <div class=\"anchor-info\">\n        <img class=\"anchor-avatar\" :src=\"avatar\">\n        <div class=\"anchor-other\">\n          <p class=\"anchor-nick\">{{nick}}</p>\n          <p class=\"online-num\">在线：{{onlineMemberCount}}</p>\n        </div>\n      </div>\n      <div class=\"online-info\">\n        <p class=\"room-name\">直播中</p>\n        <img class=\"living-icon\" src=\"../../../assets/image/living-icon.gif\" />\n        <span>{{` ${pusherTime}`}}</span>\n      </div>\n    </div>\n    <div class=\"close-box\" @click=\"closeLiveMask\">\n      <i class=\"el-icon-circle-close\"></i>\n    </div>\n  </div>\n</template>\n\n<script>\n import { mapState } from 'vuex'\n  export default {\n    name: 'liveHeader',\n    props: {\n      fr: {\n        type: String,\n        requred: true\n      },\n      isPushingStream: {\n        type: Boolean,\n        default: false\n      },\n      stopPushStream: {\n        type: Function\n      },\n      pusherTime: {\n        type: String,\n        default: ''\n      }\n    },\n    data() {\n      return {\n        nick: '',\n        avatar: 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png',\n        onlineMemberCount: 0,\n        timer: null,\n        onlineList: []\n      }\n    },\n    computed: {\n      ...mapState({\n        groupLiveInfo: state => state.groupLive.groupLiveInfo\n      }),\n      showLiveInfo() {\n        return (this.fr === 'pusher' && this.isPushingStream) || this.fr === 'player'\n      },\n      roomName() {\n        return this.groupLiveInfo.roomName || `${this.groupLiveInfo.anchorID}的直播`\n      }\n    },\n    mounted() {\n      this.getAnchorProfile()\n      if (this.fr === 'player') {\n        this.timer = setInterval(() => {\n          this.getGroupOnlineMemberCount()\n        }, 5000)\n      }\n    },\n    beforeDestroy() {\n      this.timer && clearInterval(this.timer)\n    },\n    methods: {\n      closeLiveMask() {\n        if (this.fr === 'pusher') {\n          this.stopPushStream()\n          return\n        }\n        this.$store.commit('updateGroupLiveInfo', { isNeededQuitRoom: 1 })\n        this.$bus.$emit('close-group-live')\n      },\n      async getAnchorProfile() {\n        const res = await this.tim.getUserProfile({userIDList: [this.groupLiveInfo.anchorID]})\n        if (res.code === 0) {\n          this.nick = res.data[0].nick || res.data[0].userID\n          this.avatar = res.data[0].avatar || 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\n        }\n      },\n      async getGroupOnlineMemberCount() {\n        const res = await this.tim.getGroupOnlineMemberCount(this.groupLiveInfo.roomID)\n        if (res.code === 0 && res.data) {\n          this.onlineMemberCount = res.data.memberCount\n        }\n      }\n    },\n    watch: {\n      isPushingStream: function(val) {\n        if (val && this.fr === 'pusher') {\n          this.timer = setInterval(() => {\n            this.getGroupOnlineMemberCount()\n          }, 5000)\n        }\n      }\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scoped>\n .header-container {\n   position absolute\n   left 0\n   top 0\n   width 100%\n   height 100%\n   box-sizing border-box\n   z-index 99\n   padding 10px 10px 10px 20px\n  .anchor-info {\n    position absolute\n    top 50%\n    transform translateY(-50%)\n    width 200px\n    height 50px\n    background rgba(255, 255 ,255 ,0.1)\n    border-radius 30px\n    display flex\n    align-items center\n    .anchor-avatar {\n      width 50px\n      height 50px\n      border-radius 50%\n      margin 0 5px\n    }\n    .anchor-other {\n      height 100%\n      flex 1\n      p {\n        margin 0\n      }\n      .anchor-nick{\n        max-width 140px\n        margin 6px 0 0 0\n        color: #ffffff\n        font-weight 500\n        word-break keep-all\n        overflow hidden\n        text-overflow ellipsis\n        white-space nowrap\n      }\n      .online-num{\n        font-size 14px\n        font-weight 400\n        color #d2cbcbad\n      }\n    }\n  }\n  .online-info {\n    position absolute\n    left 50%\n    top 50%\n    transform translate(-50%, -50%)\n    height 50px\n    color #fff\n    display flex\n    align-items center\n    .room-name{\n      display inline-block\n      max-width 160px\n      overflow hidden\n      white-space nowrap\n      text-overflow ellipsis\n      margin 0\n      padding 0 0 0 10px\n    }\n    .living-icon{\n      position relative\n      top -3px\n      margin 0 5px\n      width 25px\n    }\n    span {\n      margin 2px 0 0 0\n    }\n  }\n  .close-box {\n    position absolute\n    right 0\n    top 0px\n    width 70px\n    height 70px\n    color: #959798\n    font-size 36px\n    cursor pointer\n    display flex\n    align-items center\n    justify-content center\n  }\n }\n</style>\n"],"sourceRoot":"src/components/group-live/components"}]}