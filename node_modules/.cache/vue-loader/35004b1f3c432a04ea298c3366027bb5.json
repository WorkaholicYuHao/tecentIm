{"remainingRequest":"/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuhao/TIMSDK/H5/src/components/group-live/components/live-player.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuhao/TIMSDK/H5/src/components/group-live/components/live-player.vue","mtime":1616982605599},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from 'vuex'\nimport { Slider } from 'element-ui'\nimport liveHeader from './live-header'\n// import liveShare from './live-share'\nimport poster from '../../../assets/image/poster.png'\n\nexport default {\n  name: 'livePlayer',\n  data() {\n    return {\n      player: null,\n      isPlaying: true, // 是否正在播放\n      volumeValue: 70,\n      showSetVolume: false,\n      isMute: false,\n    }\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user,\n      roomID: state => state.groupLive.groupLiveInfo.roomID,\n      anchorID: state => state.groupLive.groupLiveInfo.anchorID,\n    }),\n  },\n  mounted() {\n    this.init()\n    const volumeBox = this.$refs.volumeBox\n    const progressBox = this.$refs.progressBox\n    progressBox.addEventListener('mouseover', () => {\n      this.showSetVolume = true\n    })\n    progressBox.addEventListener('mouseout', () => {\n      this.showSetVolume = false\n    })\n    volumeBox.addEventListener('mouseover', () => {\n      this.showSetVolume = true\n    })\n    volumeBox.addEventListener('mouseout', () => {\n      this.showSetVolume = false\n    })\n  },\n  beforeDestroy() {\n    this.stopPlay()\n  },\n  components: {\n    liveHeader,\n    // liveShare,\n    elSlider: Slider\n  },\n  methods: {\n    // 初始化\n    init() {\n      this.player = this.TWebLive.createPlayer()\n      this.player.setCustomConfig({\n        autoplay: true,\n        poster: { style:'cover', src: poster },\n        pausePosterEnabled: false,\n        wording: {\n          1:'您观看的直播已结束哦~ ',\n          2:'您观看的直播已结束哦~ ',\n          4:'您观看的直播已结束哦~ ',\n          13:'您观看的直播已结束',\n          2032: '请求视频失败，请检查网络',\n          2048: '请求m3u8文件失败，可能是网络错误或者跨域问题'\n        }\n      })\n      // 播放时\n      this.player.on(this.TWebLive.EVENT.PLAYER_PLAYING, this.onPlayerPlaying)\n      // 暂停\n      this.player.on(this.TWebLive.EVENT.PLAYER_PAUSE, this.onPlayerPause)\n      // 浏览器不允许自动播放\n      this.player.on(this.TWebLive.EVENT.PLAYER_AUTOPLAY_NOT_ALLOWED, this.onPlayerAutoPlayNotAllowed)\n      this.player.on(this.TWebLive.EVENT.PLAYER_ERROR, this.onPlayerError)\n      this.setRenderView()\n      this.$bus.$emit('join-group-live-avchatroom')\n    },\n    // eslint-disable-next-line no-unused-vars\n    onPlayerPlaying(event) {},\n    // eslint-disable-next-line no-unused-vars\n    onPlayerPause(event) {},\n    // eslint-disable-next-line no-unused-vars\n    onPlayerAutoPlayNotAllowed(event) {\n      this.$store.commit('showMessage', {\n        message: '不能自动播放',\n        type: 'info'\n      })\n    },\n    // eslint-disable-next-line no-unused-vars\n    onPlayerError(event) {},\n    // 设置渲染界面\n    setRenderView() {\n      this.player.setRenderView({ elementID: 'player-container' })\n      this.startPlay()\n    },\n    //开始播放\n    startPlay() {\n      const streamID = `${this.user.sdkAppID}_${this.roomID}_${this.anchorID}_main`\n      const flv = `https://tuikit.qcloud.com/live/${streamID}.flv`\n      const hls = `https://tuikit.qcloud.com/live/${streamID}.m3u8` \n      const url = `https://flv=${encodeURIComponent(flv)}&hls=${encodeURIComponent(hls)}`\n      this.player.startPlay(url).then(() => {\n        this.isPlaying = true\n      }).catch(() => {})\n    },\n    resumeAudio() {\n      this.player.resumeAudio().then(() => {\n        this.isMute = false\n      }).catch(() => {})\n    },\n    pauseAudio() {\n      this.player.pauseAudio().then(() => {\n        this.isMute = true\n      }).catch(() => {})\n    },\n    //暂停播放\n    pauseVideo() {\n      this.player.pauseVideo().then(() => {\n        this.isPlaying = false\n      }).catch(() => {})\n    },\n    // 恢复播放\n    resumeVideo() {\n      this.player.resumeVideo().then(() => {\n        this.isPlaying = true\n      }).catch(() => {})\n    },\n    setPlayoutVolume() {\n      this.player.setPlayoutVolume(this.volumeValue)\n    },\n    // 停止播放\n    stopPlay() {\n      this.player.stopPlay()\n      this.isPlaying = false\n    },\n  }\n}\n",null]}