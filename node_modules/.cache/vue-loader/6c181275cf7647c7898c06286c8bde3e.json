{"remainingRequest":"/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuhao/TIMSDK/H5/src/components/message/message-item.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuhao/TIMSDK/H5/src/components/message/message-item.vue","mtime":1616982605604},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from 'vuex'\nimport MessageStatusIcon from './message-status-icon.vue'\nimport MessageHeader from './message-header'\nimport MessageFooter from './message-footer'\nimport FileElement from './message-elements/file-element.vue'\nimport FaceElement from './message-elements/face-element.vue'\nimport ImageElement from './message-elements/image-element.vue'\nimport TextElement from './message-elements/text-element.vue'\nimport SoundElement from './message-elements/sound-element.vue'\nimport VideoElement from './message-elements/video-element.vue'\nimport GroupTipElement from './message-elements/group-tip-element.vue'\nimport GroupSystemNoticeElement from './message-elements/group-system-notice-element.vue'\nimport CustomElement from './message-elements/custom-element.vue'\nimport GeoElement from './message-elements/geo-element.vue'\n\nexport default {\n  name: 'MessageItem',\n  props: {\n    message: {\n      type: Object,\n      required: true\n    }\n  },\n  components: {\n    MessageHeader,\n    MessageFooter,\n    MessageStatusIcon,\n    FileElement,\n    FaceElement,\n    ImageElement,\n    TextElement,\n    SoundElement,\n    GroupTipElement,\n    GroupSystemNoticeElement,\n    CustomElement,\n    VideoElement,\n    GeoElement,\n  },\n  data() {\n    return {\n      renderDom: []\n    }\n  },\n  computed: {\n    ...mapState({\n      currentConversation: state => state.conversation.currentConversation,\n      currentUserProfile: state => state.user.currentUserProfile\n    }),\n    // 是否显示头像，群提示消息不显示头像\n    showAvatar() {\n      if (this.currentConversation.type === 'C2C' && !this.message.isRevoked) { // C2C且没有撤回的消息\n        return true\n      } else if (this.currentConversation.type === 'GROUP' && !this.message.isRevoked) { // group且没有撤回的消息\n        return this.message.type !== this.TIM.TYPES.MSG_GRP_TIP\n      }\n      return false\n    },\n    avatar() {\n      if (this.currentConversation.type === 'C2C') {\n        return this.message.avatar\n      } else if (this.currentConversation.type === 'GROUP') {\n        return this.isMine\n          ? this.currentUserProfile.avatar\n          : this.message.avatar\n      } else {\n        return ''\n      }\n    },\n    currentConversationType() {\n      return this.currentConversation.type\n    },\n    isMine() {\n      // console.log(this.currentUserProfile, this.currentConversation);\n      return this.message.flow === 'out'\n    },\n    messagePosition() {\n      if (\n        ['TIMGroupTipElem', 'TIMGroupSystemNoticeElem'].includes(\n          this.message.type\n        )\n      ) {\n        return 'position-center'\n      }\n      if (this.message.isRevoked) { // 撤回消息\n        return 'position-center'\n      }\n      if (this.isMine) {\n        return 'position-right'\n      } else {\n        return 'position-left'\n      }\n    },\n    showMessageHeader() {\n      if (\n        ['TIMGroupTipElem', 'TIMGroupSystemNoticeElem'].includes(\n          this.message.type\n        )\n      ) {\n        return false\n      }\n      if (this.message.isRevoked) { // 撤回消息\n        return false\n      }\n      return true\n    }\n  },\n  methods: {\n    showGroupMemberProfile(event) {\n      this.tim\n        .getGroupMemberProfile({\n          groupID: this.message.to,\n          userIDList: [this.message.from]\n        })\n        .then(({ data: { memberList } }) => {\n          if (memberList[0]) {\n            this.$bus.$emit('showMemberProfile', { event, member: memberList[0] })\n          }\n        })\n    }\n  }\n}\n",null]}