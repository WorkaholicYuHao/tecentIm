{"remainingRequest":"/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuhao/TIMSDK/H5/src/components/conversation/conversationProfile/group-profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuhao/TIMSDK/H5/src/components/conversation/conversationProfile/group-profile.vue","mtime":1616982605598},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuhao/TIMSDK/H5/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport GroupMemberList from './group-member-list.vue'\nimport { Select, Option, Switch } from 'element-ui'\nexport default {\n  props: ['groupProfile'],\n  components: {\n    GroupMemberList,\n    ElSelect: Select,\n    ElOption: Option,\n    ElSwitch: Switch,\n  },\n  data() {\n    return {\n      showEditName: false,\n      showEditFaceUrl: false,\n      showEditIntroduction: false,\n      showEditNotification: false,\n      showEditJoinOption: false,\n      showChangeGroupOwner: false,\n      showEditMessageRemindType: false,\n      showEditNameCard: false,\n      name: this.groupProfile.name,\n      avatar: this.groupProfile.avatar,\n      introduction: this.groupProfile.introduction,\n      notification: this.groupProfile.notification,\n      joinOption: this.groupProfile.joinOption,\n      newOwnerUserID: '',\n      messageRemindType: this.groupProfile.selfInfo.messageRemindType,\n      nameCard: this.groupProfile.selfInfo.nameCard || '',\n      muteAllMembers: this.groupProfile.muteAllMembers,\n      messageRemindTypeMap: {\n        AcceptAndNotify: '接收消息并提示',\n        AcceptNotNotify: '接收消息但不提示',\n        Discard: '屏蔽消息'\n      },\n      joinOptionMap: {\n        FreeAccess: '自由加入',\n        NeedPermission: '需要验证',\n        DisableApply: '禁止加群'\n      },\n      active:false\n    }\n  },\n  computed: {\n    editable() {\n      return (\n        this.groupProfile.type === this.TIM.TYPES.GRP_WORK ||\n        [this.TIM.TYPES.GRP_MBR_ROLE_OWNER, this.TIM.TYPES.GRP_MBR_ROLE_ADMIN].includes(this.groupProfile.selfInfo.role)\n      )\n    },\n    isOwner() {\n      return this.groupProfile.selfInfo.role === this.TIM.TYPES.GRP_MBR_ROLE_OWNER\n    },\n    isAdmin() {\n      return this.groupProfile.selfInfo.role === this.TIM.TYPES.GRP_MBR_ROLE_ADMIN\n    },\n    showDissmissGroup() {\n      // 好友工作群不能解散\n      return this.isOwner && this.groupProfile.type !== this.TIM.TYPES.GRP_WORK\n    },\n    groupType() {\n      switch (this.groupProfile.type) {\n        case this.TIM.TYPES.GRP_WORK:\n          return '好友工作群（Work）'\n        case this.TIM.TYPES.GRP_PUBLIC:\n          return '陌生人社交群（Public）'\n        case this.TIM.TYPES.GRP_CHATROOM:\n          return '临时会议群（Meeting）'\n        case this.TIM.TYPES.GRP_AVCHATROOM:\n          return '直播群（AVChatRoom）'\n        default:\n          return ''\n      }\n    }\n  },\n  watch: {\n    groupProfile(groupProfile) {\n      Object.assign(this, {\n        showEditName: false,\n        showEditFaceUrl: false,\n        showEditIntroduction: false,\n        showEditNotification: false,\n        showEditJoinOption: false,\n        showChangeGroupOwner: false,\n        showEditNameCard: false,\n        name: groupProfile.name,\n        avatar: groupProfile.avatar,\n        introduction: groupProfile.introduction,\n        notification: groupProfile.notification,\n        joinOption: groupProfile.joinOption,\n        messageRemindType: groupProfile.messageRemindType,\n        nameCard: groupProfile.selfInfo.nameCard || '',\n        muteAllMembers: groupProfile.muteAllMembers,\n      })\n    }\n  },\n  methods: {\n    inputFocus(ref) {\n      this.$nextTick(() => {\n        this.$refs[ref].focus()\n      })\n    },\n    editName() {\n      this.tim\n        .updateGroupProfile({\n          groupID: this.groupProfile.groupID,\n          name: this.name.trim()\n        })\n        .then(() => {\n          this.showEditName = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    editFaceUrl() {\n      this.tim\n        .updateGroupProfile({\n          groupID: this.groupProfile.groupID,\n          avatar: this.avatar.trim()\n        })\n        .then(() => {\n          this.showEditFaceUrl = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    changeMuteStatus() {\n      if (this.isOwner || this.isAdmin) {\n        this.tim\n          .updateGroupProfile({\n          muteAllMembers: this.muteAllMembers,\n          groupID: this.groupProfile.groupID\n        })\n          .then(imResponse => {\n          this.muteAllMembers = imResponse.data.group.muteAllMembers\n          if (this.muteAllMembers) {\n            this.active = true\n            this.$store.commit('showMessage', {\n              message: '全体禁言'\n            })\n          } else {\n            this.active = false\n            this.$store.commit('showMessage', {\n              message: '取消全体禁言'\n            })\n          }\n        })\n          .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n      } else {\n        this.muteAllMembers = this.groupProfile.muteAllMembers\n        this.$store.commit('showMessage', {\n          type: 'error',\n          message: '普通群成员不能对全体禁言'\n        })\n      }\n    },\n    editIntroduction() {\n      this.tim\n        .updateGroupProfile({\n          groupID: this.groupProfile.groupID,\n          introduction: this.introduction.trim()\n        })\n        .then(() => {\n          this.showEditIntroduction = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    editNotification() {\n      this.tim\n        .updateGroupProfile({\n          groupID: this.groupProfile.groupID,\n          notification: this.notification.trim()\n        })\n        .then(() => {\n          this.showEditNotification = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    editJoinOption() {\n      this.tim\n        .updateGroupProfile({\n          groupID: this.groupProfile.groupID,\n          joinOption: this.joinOption\n        })\n        .then(() => {\n          this.showEditJoinOption = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    changeOwner() {\n      this.tim\n        .changeGroupOwner({\n          groupID: this.groupProfile.groupID,\n          newOwnerID: this.newOwnerUserID\n        })\n        .then(() => {\n          this.showChangeGroupOwner = false\n          this.$store.commit('showMessage', {\n            message: `转让群主成功，新群主ID：${this.newOwnerUserID}`\n          })\n          this.newOwnerUserID = ''\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    quitGroup() {\n      this.tim.quitGroup(this.groupProfile.groupID).then(({ data: { groupID } }) => {\n        this.$store.commit('showMessage', {\n          message: '退群成功'\n        })\n        if (groupID === this.groupProfile.groupID) {\n          this.$store.commit('resetCurrentConversation')\n        }\n      })\n      .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    dismissGroup() {\n      this.tim.dismissGroup(this.groupProfile.groupID).then(({ data: { groupID } }) => {\n        this.$store.commit('showMessage', {\n          message: `群：${this.groupProfile.name || this.groupProfile.groupID}解散成功！`,\n          type: 'success'\n        })\n        if (groupID === this.groupProfile.groupID) {\n          this.$store.commit('resetCurrentConversation')\n        }\n      })\n      .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    editMessageRemindType() {\n      this.tim\n        .setMessageRemindType({\n          groupID: this.groupProfile.groupID,\n          messageRemindType: this.messageRemindType\n        })\n        .then(() => {\n          this.showEditMessageRemindType = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    editNameCard() {\n      if (this.nameCard.trim().length === 0) {\n        this.$store.commit('showMessage', {\n          message: '不能设置空的群名片',\n          type: 'warning'\n        })\n        return\n      }\n      this.tim\n        .setGroupMemberNameCard({\n          groupID: this.groupProfile.groupID,\n          nameCard: this.nameCard.trim()\n        })\n        .then(() => {\n          this.showEditNameCard = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    }\n  }\n}\n",null]}